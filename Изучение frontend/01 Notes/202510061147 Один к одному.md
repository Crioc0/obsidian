---
created: 2025-10-06 11:47
tags:
  - typeORM
---
# 202510061147
*Ссылка на StructureNote:*
*Ссылка на исходник или контекст (если есть):* 

 Две таблицы: одна для страны, другая для столиц — и идентификатор, связывающий их. Он может быть у любой из сущностей или у обеих сразу.
 **Country**

|id|name|
|---|---|
|1|Россия|
|2|Англия|

**Capital**

|id|name|country_id|
|---|---|---|
|1|Москва|1|
|2|Лондон|2|

В TypeORM для описания отношений между таблицами используются соответствующие декораторы. В данном случае это будет декоратор `OneToOne`.
```ts
// /entities/Country.entity.ts

import {Entity, PrimaryGeneratedColumn, Column} from "typeorm";
import {Capital} from "./entities/Capital";

@Entity()
export class Country {

    @PrimaryGeneratedColumn()
    id: number;

    @Column()
    name: string;

    // Первым параметром идёт связываемая сущность (столица),
    // а вторым — поле, по которому выполняется связь этой сущности:
    @OneToOne(() => Capital, capital => capital.country)
    capital: Capital;

}
```
В описании столицы мы также добавляем декоратор `OneToOne` — уже без поля, так как оно описано в модели страны, зато с декоратором `JoinColumn`.
```ts
// /entities/Capital.entity.ts
import {
  Entity,
  PrimaryGeneratedColumn,
  Column,
  OneToOne,
  JoinColumn,
} from 'typeorm';
import { Country } from './entities/Country';

@Entity()
export class Capital {
  @PrimaryGeneratedColumn()
  id: number;

  @Column()
  name: string;

  @OneToOne(() => Country)
  @JoinColumn() // создаст Foreign Key и не даст создать столицу
  // без указания страны.
  country: Country;
}
```
После запуска мы получим примерно такие таблицы в базе:
```ts
+-------------+--------------+----------------------------+
|                        country                          |
+-------------+--------------+----------------------------+
| id          | int(11)      | PRIMARY KEY AUTO_INCREMENT |
| name        | varchar(255) |                            |
+-------------+--------------+----------------------------+

+-------------+--------------+----------------------------+
|                          capital                        |
+-------------+--------------+----------------------------+
| id          | int(11)      | PRIMARY KEY AUTO_INCREMENT |
| name        | varchar(255) |                            |
| countryId   | int(11)      | FOREIGN KEY                |
+-------------+--------------+----------------------------+
```
Для обеспечения целостности базы здесь появляется `FOREIGN KEY` — это специальный механизм БД, ограничитель, который проверяет наличие связанного поля в другой таблице. То есть в данном случае у нас не получится создать столицу без указания страны или с указанием `id` страны, которого не существует в таблице стран.

Обратите внимание, что `FOREIGN KEY` может быть только на одной таблице, которая считается вторичной. В данном случае это таблица столицы.
### Связанные идеи:
* 
---

*Что стоит развить? Какие вопросы возникли?*