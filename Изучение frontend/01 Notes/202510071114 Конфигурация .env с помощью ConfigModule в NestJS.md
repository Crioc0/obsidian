---
created: 2025-10-07 11:14
tags:
  - nestjs
repeat: spaced every day
due_at: 2025-10-24T06:00:00.000+03:00
---
# 202510071114 Конфигурация .env с помощью ConfigModule в NestJS

*Ссылка на StructureNote:*
*Ссылка на исходник или контекст (если есть):* [ЯПрактикум](https://practicum.yandex.ru/trainer/backend-nodejs/lesson/64506ddc-7e9d-440a-acf6-bda3f77dd69f/)

Удобнее всего хранить все переменные в специальном файле — `.env` (читается “dotenv”). Файл `.env` создают в корне проекта.

Чтобы использовать значения из `.env`, достаточно импортировать `ConfigModule` из `@nestjs/config`и подключить его к корневому модулю с помощью метода `forRoot`:

```ts
import { Module } from '@nestjs/common';
import { ConfigModule } from '@nestjs/config';

@Module({
  imports: [ConfigModule.forRoot()],
})
export class AppModule {}
```

Можно указать путь до `.env` файла, например, если для разных окружений используются разные файлы. Чаще всего значения в `.env` будут отличаться для разных окружений. Например, для тестов может потребоваться база с тестовыми данными, а продакшен база может лежать на удалённом сервере. Поэтому в `envFilePath` можно передать массив с названиями файлов. `ConfigModule` будет использовать первый найденный файл:

```ts
import { Module } from '@nestjs/common';
import { ConfigModule } from '@nestjs/config';

@Module({
  imports: [
    ConfigModule.forRoot({
      envFilePath: ['.env.testing', '.env.development', '.env']
    }),
  ],
})
export class AppModule {}
```

`ConfigModule` экспортирует провайдер `ConfigService`, который вы можете использовать внутри своих контроллеров или провайдеров

```ts
import { Injectable } from '@nestjs/common';
import { ConfigService } from '@nestjs/config';

@Injectable()
export class AppService {
  constructor(private configService: ConfigService) {
    const databaseURL = this.configService.get<string>('DATABASE_URL', 'postgres://localhost');
    const databaseName = this.configService.get<string>('DATABASE_NAME', 'db');
  }
}
```

Не забывайте, чтобы `ConfigService` был доступен внутри провайдера или контроллера, вам нужно импортировать `ConfigModule` в тот же модуль. Но уже без параметров, они будут сохранены при первом вызове `forRoot` в корневом модуле

У каждого модуля будет своя конфигурация. Модулю для работы с базой нужны данные для подключения, модулю авторизации нужны секреты для хэширования паролей и так далее. Поэтому для каждого модуля `ConfigModule` будет подключаться отдельно.

Но иногда значения из конфигурации должны быть доступны глобально. Например, название текущего окружения: `development`, `testing`, `production`. Тогда можно зарегистрировать `ConfigModule` в корневом модуле `AppModule` и передать параметр `isGlobal`. Так значения будут доступны глобально:

```ts
import { Module } from '@nestjs/common';
import { ConfigModule } from '@nestjs/config';

@Module({
  imports: [
    ConfigModule.forRoot({ isGlobal: true } ),
  ],
})
export class AppModule {}
```

### Связанные идеи:

* [[202510071058 Конфигурация сервера. ENV. ConfigModule Nest.js]]
---

*Что стоит развить? Какие вопросы возникли?*
