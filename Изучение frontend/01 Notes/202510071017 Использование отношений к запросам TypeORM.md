---
created: 2025-10-07 10:17
tags:
  - typeORM
  - уровень_1
repeat: spaced every day
due_at: 2025-10-24T06:00:00.000+03:00
---
# 202510071017 Использование отношений к запросам TypeORM

*Ссылка на StructureNote:* [[TypeORM]]
*Ссылка на исходник или контекст (если есть):* [ЯПрактикум](https://practicum.yandex.ru/learn/backend-nodejs/courses/a4214ab0-2146-4152-b90e-651bf4c7ca5e/sprints/564244/topics/104f2765-a9c9-4617-8a5e-f21b675cf9b3/lessons/5674c491-8940-41ba-bf49-d6da1cbe2337/)

Если вы корректно указали отношения между сущностями в `entities`, то при запросах репозитория вы сможете уточнять, нужна вам связанная сущность или нет. Например:

```ts
const post = await postRepository.findOne({
    where: {
        id: 1,
    },
    relations: {
        categories: true,
    },
})
```

По умолчанию отношения (`relations`) не используются, и вы получите только ту сущность, что запрашивали. То есть пример выше вернёт связанную сущность `categories`. А если не указать `relations` — не вернёт.

Лучше иметь много различных функций сервиса, которые возвращают только требуемые данные, чем одну, которая вернёт супер-объект.

Так не стоит делать

```ts
export class userService {
...
    async getAllPossibleUserInfo(id: number){
        return userRepository.findOne({
            where: {
                id,
            },
            relations: {
                pets: true,
              address: true,
              bank_accounts: true,
              relatives: true,
            },
        });
    }
}
```

Лучше делать так:

```ts
export class userService {
...
    async getUserInfo(){
        return userRepository.findOne({
            where: {
                id,
            }
        });
    }
    async getUserWithAddress(){
        return userRepository.findOne({
            where: {
                id,
            },
            relations: {
              address: true,
            },
        });
    }
    async getWithRelatives(){
        return userRepository.findOne({
            where: {
                id,
            },
            relations: {
              relatives: true,
            },
        });
    }
...
}
```

### Связанные идеи:

* 

---

*Что стоит развить? Какие вопросы возникли?*
