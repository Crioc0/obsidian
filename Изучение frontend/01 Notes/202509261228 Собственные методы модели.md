---
created: 2025-09-26 12:28
tags:
  -
---
# 202509261228
*Ссылка на StructureNote:*
*Ссылка на исходник или контекст (если есть):* [ЯПратикум](https://practicum.yandex.ru/learn/backend-nodejs/courses/16b47298-e20d-4fde-9619-1ab305039a00/sprints/564238/topics/a4928f0d-5f69-4053-bea3-fa90d3a2a89f/lessons/439af0bf-e5a0-40f7-ab37-83313c9ea723/)

Методы модели реализуют базовые CRUD-операции и некоторые служебные, такие как работа с индексами. С Mongoose мы можем не только использовать встроенные методы, но и описывать собственные. Благодаря этому:

- Можно упаковать логику работы с документами внутрь модели. Везде, где импортирована модель, будут доступны и наши собственные методы.
- Однозначно связать действия в БД с указанной моделью.
- Сократить объём кода.

Чаще всего собственные методы модели используются для рутинных операций, таких как поиск пользователя по почте и паролю, блокировки и удаления неактивных пользователей.

Сделать это позволяет Mongoose. Чтобы добавить собственный метод, запишем его в свойство `statics` нужной схемы. Функция не должна быть стрелочной для того, чтобы можно было пользоваться  `this

```ts
// models/user.ts
import mongoose from 'mongoose';

const userSchema = new mongoose.Schema({
  email: {
    type: String,
    required: true,
    unique: true
  },
  password: {
    type: String,
    required: true,
    minlength: 8
  }
});

userSchema.static('findUserByCredentials', function findUserByCredentials(email: string, password: string) {
  return this.findOne({ email })
    .then((user) => {
      if (!user) {
        return Promise.reject(new Error('Неправильные почта или пароль'));
      }

      return bcrypt.compare(password, user.password)
        .then((matched) => {
          if (!matched) {
            return Promise.reject(new Error('Неправильные почта или пароль'));
          }

          return user; // теперь user доступен
        });
    });
};

export default mongoose.model('user', userSchema);
```
### Связанные идеи:
* [[202509260828 Модели mongoose]]
---

*Что стоит развить? Какие вопросы возникли?*
1) Особенность работы статик
2) Работа с `this`