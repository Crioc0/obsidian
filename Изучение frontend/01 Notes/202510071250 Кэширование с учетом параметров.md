---
created: 2025-10-07 12:50
tags:
  - unknown-tag
---
# 202510071250
*Ссылка на StructureNote:*
*Ссылка на исходник или контекст (если есть):* [ЯПрактикум](https://practicum.yandex.ru/trainer/backend-nodejs/lesson/c853ccd2-0bf3-4f5d-9bb9-b319db84e934/task/b04bd35c-bf4e-48f0-9512-98d11fa8c2c8/)

```ts
function await updateUserById(id: string, data: object) {
  const cacheKey = 'user';

  // если мы обновили данные пользователя в БД,

  await usersDb.updateOne({ id }, object);
  // проинвалидируем кэш
  cache.del(cacheKey);
}
```
Здесь в качестве ключа используется строка `user` вне зависимости от идентификатора пользователя. Это значит, что для любого пользователя будут использоваться одни и те же данные в кэше. Чтобы хранить данные для каждого пользователя отдельно, кэшировать нужно с учётом параметров.

Чтобы такого не случалось, нужно формировать ключ кэширования вместе с идентификатором пользователя:
```ts
async function findUserById(id: string) {
  const cacheKey = `user:${id}`;

  if (cache.get(cacheKey) === undefined) {
    const user = await usersDb.findOne({ id });

    cache.set(cacheKey, user);
  }

  return cache.get(cacheKey);
}
```

### Связанные идеи:
* 
---

*Что стоит развить? Какие вопросы возникли?*