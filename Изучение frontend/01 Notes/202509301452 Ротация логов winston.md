---
created: 2025-09-30 14:52
tags:
  - nodejs
---
# 202509301452
*Ссылка на StructureNote:*
*Ссылка на исходник или контекст (если есть):* 

Чтобы реализовать ротацию логов в `winston`, можно использовать пакет [`winston-daily-rotate-file`](https://github.com/winstonjs/winston-daily-rotate-file) (его нужно установить с помощью `npm` отдельно). Он предоставляет транспорт, который создаёт новый лог-файл каждый день:
```ts
import winston from 'winston';
import expressWinston from 'express-winston';

import 'winston-daily-rotate-file';

const transport = new winston.transports.DailyRotateFile({
    // указываем формат имени файла
  filename: 'error-%DATE%.log',
    // указываем шаблон для даты
  datePattern: 'YYYY-MM-DD-HH',
});

});

```
Помимо ежедневной ротации, можно создавать новый файл, если старый превышает определённый размер. Нужно указать опцию `maxSize`:
```ts
const transport = new winston.transports.DailyRotateFile({
  filename: 'error-%DATE%.log',
  datePattern: 'YYYY-MM-DD-HH',
  maxSize: '20m',
});
```
С помощью опции `zippedArchive` можно хранить лог-файлы, сжатыми в zip-архив, чтобы они занимали меньше места
```ts
const transport = new winston.transports.DailyRotateFile({
  filename: 'error-%DATE%.log',
  datePattern: 'YYYY-MM-DD-HH',
  zippedArchive: true,
});
```
А старые файлы можно удалять автоматически, указав опцию `maxFiles`. Значением может быть как количество файлов, так и количество дней, в течение которых нужно хранить файлы:
```ts
const transport = new winston.transports.DailyRotateFile({
  filename: 'error-%DATE%.log',
  datePattern: 'YYYY-MM-DD-HH',
  maxFiles: 14, // или '14d', тогда будут хранится файлы только за последние 14 дней
});
```
### Связанные идеи:
* [[202509301412 Библиотека для логирования winston]]
* 
---

*Что стоит развить? Какие вопросы возникли?*