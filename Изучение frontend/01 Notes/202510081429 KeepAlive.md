---
repeat: spaced every day
created: 2025-10-08 14:29
tags:
  - vue
---
# 202510081429 KeepAlive

*Ссылка на StructureNote:*
*Ссылка на исходник или контекст (если есть):*

`<KeepAlive>` это встроенный компонент, который позволяет условно кэшировать экземпляры компонентов при динамическом переключении между несколькими компонентами.

По умолчанию активный экземпляр компонента будет размонтирован при переключении с него. Это приведет к потере любого измененного состояния, которое оно содержит. При повторном отображении этого компонента будет создан новый экземпляр только с начальным состоянием.

Если обернуть компонент в KeepAlive, то состояние будет сохраняться при переключении компонентов

## Включение / Исключение

По умолчанию `<KeepAlive>` будет кэшировать любой экземпляр компонента внутри. Мы можем настроить это поведение с помощью параметров `include` и `exclude`. Оба свойства могут быть строками, разделенными запятыми, `RegExp`, или массивами, содержащими элементы типа:

## Максимальное количество кэшированных экземпляров[​](https://ru.vuejs.org/guide/built-ins/keep-alive.html#max-cached-instances)

Мы можем ограничить максимальное количество экземпляров компонентов, которые можно кэшировать с помощью опции `max`. Когда `max` задан, `<KeepAlive>` ведет себя как [LRU cache](https://en.wikipedia.org/wiki/Cache_replacement_policies#Least_recently_used_\(LRU\)): если количество закэшированных экземпляров вот-вот превысит указанное максимальное количество, то наименее недавно использованный закэшированный экземпляр будет уничтожен, чтобы освободить место для нового.

## Жизненный цикл кэшированного экземпляра[​](https://ru.vuejs.org/guide/built-ins/keep-alive.html#lifecycle-of-cached-instance)

Когда экземпляр компонента удаляется из DOM, но является частью дерева компонентов, кэшированного `<KeepAlive>`, он переходит в состояние **деактивированного,** вместо того, чтобы быть размонтированным. Когда экземпляр компонента вставляется в DOM как часть кэшированного дерева, он **активируется**.

Также наш компонент может регистрировать хуки жизненного цикла для этих двух состояний [`onActivated()`](https://ru.vuejs.org/api/composition-api-lifecycle.html#onactivated) и [`onDeactivated()`](https://ru.vuejs.org/api/composition-api-lifecycle.html#ondeactivated):

```js
<script setup>
import { onActivated, onDeactivated } from 'vue'

onActivated(() => {
  // вызывается при первоначальном монтировании
  // и каждый раз, когда он повторно вставляется из кэша
})

onDeactivated(() => {
  // вызывается, когда удаляется из DOM в кэш
  // и также при размонтировании
})
</script>
```

Обратите внимание, что:

- `onActivated` также вызывается при монтировании, и `onDeactivated` при размонтировании.
- Оба хука работают не только с корневым компонентом, кэшированным `<KeepAlive>`, но и с дочерними компонентами в кэшированном дереве.

# Связанные идеи:

* [[202510081419 Встроенные компоненты в  Vue]]

---

*Что стоит развить? Какие вопросы возникли?*
