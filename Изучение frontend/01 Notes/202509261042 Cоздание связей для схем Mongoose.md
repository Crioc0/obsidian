---
created: 2025-09-26 10:42
tags:
  - mongoose
  - backend
---
# 202509261042 Cоздание связей для схем Mongoose

*Ссылка на StructureNote:* 
*Ссылка на исходник или контекст (если есть):* [ЯПрактикум](https://practicum.yandex.ru/learn/backend-nodejs/courses/16b47298-e20d-4fde-9619-1ab305039a00/sprints/564238/topics/a4928f0d-5f69-4053-bea3-fa90d3a2a89f/lessons/b0497b25-0394-458a-b883-a4607bbfaa3c/)

Для связи одного документа с другим можно воспользоваться идентификатором `_id`

Что сделать это на уровне схемы, полю следует установить специальный тип - `mongoose.Schema.Types.ObjectId` и свойство `ref`. В это свойство записывают имя модели, на которую мы ссылаемся

```ts
const adSchema = new mongoose.Schema({
  title: {
    type: String,
    minlength: 2,
    maxlength: 20,
    required: true,
  },
  text: {
    type: String,
    minlength: 2,
    required: true,
  },
  // создаём поле creator
  creator: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'user',
    required: true
  },
});
```

Теперь при создании документа нужно будет указать уникальный идентификатор документа, с которым необходимо связать этот документ.

Чтобы получить данные по `_id`, нужно вызвать метод `populate` с именем поля в качестве аргумента. Чтобы отправить в ответе несколько полей, полученных из связей, методу `populate` следует передавать массив

```ts
// controllers/ads.js

const Ad = require('../models/ad');

module.exports.getAds = (req, res) => {
  Ad.find({})
    .populate(['creator', 'followers'])
    .then(ad => res.send({ data: ad }));
};
```

### Связанные идеи:

* [[202509260815 Схемы mongoose]]
---

*Что стоит развить? Какие вопросы возникли?*
1) Подробнее о методе populate? Как это работает?
