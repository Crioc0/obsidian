2025 09 2316 12
Tags: #безопасность 
###### Links: 
1) 
# Заметка
Основная защита от XSS — правильно написанный код веб-приложения: с ограниченным вводом и экранированием символов. Но бывает всякое, и злоумышленник всё равно может найти способ внедрить скрипт в браузер пользователя. На этот случай есть вторая линия защиты — инструкция Content Security Policy.
Эта инструкция позволяет ограничить источники, откуда сайт может загружать скрипты, изображения, файлы стилей и медиафайлы.

Есть два варианта установить инструкцию:
1) 1. В метатеге. Можно добавить в раздел `head` тег `meta` и описать ограничения там:
```ts
<meta http-equiv="Content-Security-Policy" content="ИНСТРУКЦИИ">
```
2) 2. В HTTP-заголовке:
```ts
Content-Security-Policy: /* ИНСТРУКЦИИ */
```
## Как оформить инструкцию?

Есть 5 видов инструкций:

- `default-src` — обязательная инструкция, задаёт источник всех видов ресурсов по умолчанию;
- `script-src` — источник скриптов;
- `img-src` — изображения;
- `media-src` — аудио- и видео-файлы;
- `style-src` — файлы стилей.