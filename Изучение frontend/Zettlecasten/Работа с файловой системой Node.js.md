2025 09 1010 59
Tags: #nodejs 
###### Links: 
1) [[Указание пути к файлу Node.js]]
2) [[Основные методы для работы с fs]]
# Заметка
Для работы с файлами в ноде используется модуль fs.
Для чтения используется функция readFile. Функция работает асинхронно и принимает два аргумента - имя файла и коллбэк. В коллбэке указывается, что нужно сделать с прочитанными файлами
На вход колбэк принимает два аргумента: ошибку и данные файла.
```ts
import fs from 'fs';

fs.readFile('data.json', (err, data) => {
  if (err) {
    console.log(err);
    return;
  }

  console.log('data: ', data.toString('utf8'));
});
```
В первый параметр приходит одно из двух значений
1) объект ошибки, если была ошибка при чтении файла
2) null, если ответ пришел и все хорошо

Второй параметр- данные файла - приходят в виде буфера (двоичных данных). Прежде чем работать с данными, их нужно преобразовать в строку одним из двух способов.
1) Метод toString с нужной кодировкой
2) Передать кодировку внутри свойства encoding
```ts
  import fs from 'fs';

  fs.readFile('data.json', { encoding: 'utf8' }, (err, data) => { // передали вторым аргументом объект опций. Он содержит свойство encoding, куда записывают кодировку данных
    if (err) {
      console.log(err);
      return;
    }

    console.log('data: ', data);
  });
```
## Промисы при работе с файлами
В 10 версии Node.js в модуле fs появилась поддержка промисов. Промис разрешается с прочитанными данными или отклоняется в случае ошибки. Для обработки ошибок при выполнении кода добавим в промисе `.catch`.
```ts
import fsPromises from 'fs/promises';

fsPromises.readFile('data.json', { encoding: 'utf8' })
  .then((data) => {
    console.log(data);
  })
  .catch(err => {
    console.log(`Произошла ошибка ${err.message}`);
  });
```