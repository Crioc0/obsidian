2025 09 0415 40
Tags: #nodejs
###### Links: 
1) 
# Заметка
Для создания протейшего сервера нужно сделать несколько шаогов
## Подключить API
Серверную программу нужно научить принимать сообщения, которые поступают на сетевую карту. Для этого можно использовать модуль http, который содержит реализацию веб-сервера для Node.js
```js
import http from 'http'
```
## Создать сервер
Чтобы создать сервер, нужно обратиться к методу createServer()
```js
const server = http.createServer()
```
## Настроить порт
Сообщения, которые приходят на сетевую карту, могут принимать несколько программ. Чтобы это было возможно, у сетевой карты есть точки входа — порты. Всего их 65536.
Node.js нужно знать, с какого порта принимать сообщения. Для этого используют метод listen
```js
server.listen()
```
## Установить ответ
Чтобы отреагтровать на входящие сообщения, можно передать функции createServer колбэк
```js
const server = http.createServer(() => { console.log('Пришёл запрос!'); });
```
## Настроить запрос и ответ
В коллбэк можно передать параметры. Первый параметр-объект запроса, второй-объект ответа.
```js
import http from 'http'; 
// импортируем типы для запроса и ответа 
import { IncomingMessage, ServerResponse } from 'http'; 
const server = http.createServer((request:IncomingMessage,response:ServerResponse) => { 
	console.log('Пришёл запрос!'); 
	console.log(request); 
	console.log(response); 
});
```
### Объект запроса
Обычно его называют `request`, или сокращённо `req`. Вся информация о запросе содержится в свойствах объекта:
```ts
// запустите этот файл и перейдите
// в браузере по адресу: http://localhost:3000/hello
import http from 'http';
// импортируем типы для запроса и ответа
import { IncomingMessage, ServerResponse } from 'http'; 

const server = http.createServer((req:IncomingMessage, res: ServerResponse) => {
  console.log(req.url); // /hello
  console.log(req.method); // GET
  console.log(req.headers); // здесь будут заголовки запроса
});

server.listen(3000);
```
### Объект ответа
Второй параметр обработчика называют `response`, или `res`. Он содержит свойства и методы для работы с ответом:
```ts
// запустите этот файл и перейдите
// в браузере по адресу: http://localhost:3000
import http from 'http';
// импортируем типы для запроса и ответа
import { IncomingMessage, ServerResponse } from 'http';

const server = http.createServer((req:IncomingMessage, res: ServerResponse) => {
  res.statusCode = 200; // статус ответа
  res.statusMessage = 'OK'; // сообщение ответа
  res.setHeader('Content-Type', 'text/plain'); // добавить ответу заголовок

  res.write('Hello, '); // отправить часть ответа — строку "Hello, "
  res.write('world!'); // отправить часть ответа — строку "world!"

  res.end(); // закончить отправку ответа
});

server.listen(3000);
```
Ответ можно отправить частями методом `res.write`.
Когда все данные получены, вызываем метод `res.end`. Так мы обозначаем, что ответ пришёл полностью. Обратите внимание: отправку всех частей ответа нужно прописать до вызова `res.end`.
Код статуса ответа и заголовки можно передать одним методом — `writeHead`:
```ts
import http from 'http';
// импортируем типы для запроса и ответа
import { IncomingMessage, ServerResponse } from 'http';

const server = http.createServer((req: IncomingMessage, res: ServerResponse) => {
    res.writeHead(200, {
        'Content-Type': 'text/html; charset=utf8'
    });
    // в методе end тоже можно передать данные
    res.end('<h1>Привет, мир!</h1>', 'utf8');
});

server.listen(3000); 
```