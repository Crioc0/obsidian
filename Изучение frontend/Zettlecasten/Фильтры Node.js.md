2025 09 1214 48
Tags: #MongoDB 
###### Links: 
1) 
# Заметка
Фильтр для запросов к MongoDB выглядит как обычный JavaScript-объект, построенный по определённым правилам. В общем случае его можно описать так:
```ts
{
  <field>: {
        <operator>: <expression> or <value>,
        <operator>: <expression> or <value>
    },
    <field>: {
        <operator>: <expression> or <value>
    }
}
```
Операторы всегда начинаются с символа `$`, например, для поиска по значению можно составить такой фильтр:
```ts
{
  // поле, по которому ищем
  "name": {
    // оператор и значение
    "$eq": "John Doe"
  }
}
```
Эквивалентно
```ts
{
  "name": "John Doe"
}
```
Можно запрашивать значениея со значениями больше или меньше нужнго с помощью `$gte` , `$gt`, `$lte`,  `$lt`

```ts
{
    // поле age больше или равно 18
  "age": { "$gte": 18 },
}
```

Можно запросить все документы, в которых поле существует или не существует, с помощью оператора `$exists`:
```ts
{
    // обратите внимание, если значение поля null или undefined, оно всё равно существует
    "username": { "$exists": true },
}
```
С помощью оператора `$regex` можно проверять значения на соответствие регулярному выражению:
```ts
{ 
    "phone": { "$regex": /^\+7999/ },
}
```
Для регулярного выражения есть упрощённая запись:
```ts
{    
  "email": /@yandex\.ru$/
}
```
А ещё мы можем найти документы, в которых содержится регулярное выражение. Так как упрощённая запись для регулярных выражений совпадает с упрощённой записью оператора `$eq`, нужно явно его использовать:
```ts
{
    // запрос вернёт документы, в которых поле nameRegex точно равно переданному выражению
    "nameRegex": { "$eq": /^[a-z0-9_-]{3,16}$/ }
}
```