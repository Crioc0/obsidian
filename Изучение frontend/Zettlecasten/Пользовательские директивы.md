2025 06 3016 59
Tags: #vue 
###### Links: 
1) 
# Заметка
Помимо стандартного набора директив, поставляемых в ядре (например, `v-model` или `v-show`), Vue также позволяет регистрировать собственные пользовательские директивы. Пользовательская директива определяется как объект, содержащий хуки жизненного цикла, аналогичные хукам компонента. Хуки получают элемент, к которому привязана директива.
```js
<script setup>
// включение v-highlight в шаблоне
const vHighlight = {
  mounted: (el) => {
    el.classList.add('is-highlight')
  }
}
</script>

<template>
  <p v-highlight>This sentence is important!</p>
</template>
```
Также часто встречается глобальная регистрация пользовательских директив на уровне приложения:
```js
const app = createApp({})

// сделать v-highlight пригодным для использования во всех компонентах
app.directive('highlight', {
  /* ... */
})
```
Пользовательские директивы следует использовать только тогда, когда желаемая функциональность может быть достигнута только через прямое манипулирование DOM.
## Хуки директив
Объект определения директивы может предоставлять несколько функций хуков (все они необязательны):
```js
const myDirective = {
  // вызывается до применения атрибутов
  // связанного элемента или слушателей событий
  created(el, binding, vnode) {
    // подробнее об аргументах см. ниже
  },
  // вызывается непосредственно перед вставкой элемента в DOM.
  beforeMount(el, binding, vnode) {},
  // вызывается, когда родительский компонент связанного
  // элемента и все его дочерние элементы смонтированы.
  mounted(el, binding, vnode) {},
  // вызывается перед обновлением родительского компонента
  beforeUpdate(el, binding, vnode, prevVnode) {},
  // вызывается после обновления родительского
  // компонента и всех его дочерних компонентов
  updated(el, binding, vnode, prevVnode) {},
  // вызывается перед размонтированием родительского компонента
  beforeUnmount(el, binding, vnode) {},
  // вызывается при размонтировании родительского компонента
  unmounted(el, binding, vnode) {}
}
```
### Аргументы хуков
Эти аргументы передаются хукам директив:

- `el`: элемент, к которому привязана директива. Это может быть использовано для прямого манипулирования DOM.
    
- `binding`: объект, содержащий следующие свойства.
    
    - `value`: Значение, передаваемое директиве. Например, в `v-my-directive="1 + 1"` значение будет равно `2`.
    - `oldValue`: Предыдущее значение, доступное только в `beforeUpdate` и `updated`. Оно доступно независимо от того, изменилось значение или нет.
    - `arg`: Аргумент, передаваемый директиве, если таковой имеется. Например, в `v-my-directive:foo` аргумент будет следующим `"foo"`.
    - `modifiers`: Объект, содержащий модификаторы, если таковые имеются. Например, в `v-my-directive.foo.bar` объект модификаторов будет иметь вид `{ foo: true, bar: true }`.
    - `instance`: Экземпляр компонента, в котором используется директива.
    - `dir`: объект определения директивы.
- `vnode`: базовый VNode, представляющий связанный элемент.
    
- `prevVnode`: VNode, представляющий связанный элемент из предыдущего рендера. Доступно только в хуках `beforeUpdate` и `updated`.
