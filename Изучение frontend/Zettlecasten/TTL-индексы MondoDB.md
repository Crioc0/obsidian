2025 09 1610 23
Tags: #MongoDB 
###### Links: 
1) 
# Заметка
При решении многих задач в программировании данные имеют ценность и актуальность лишь ограниченное время. Прогноз погоды, курсы валют и, конечно, сессии пользователей имеют содержательный смысл лишь некоторое время, а затем устаревают.

Мы можем отслеживать актуальность данных самостоятельно, но тогда нам потребуется описывать логику мониторинга и следить, чтобы наша служба мониторинга не упала, оставив нас с неактуальными данными.


Мы можем отслеживать актуальность данных самостоятельно, но тогда нам потребуется описывать логику мониторинга и следить, чтобы наша служба мониторинга не упала, оставив нас с неактуальными данными.

Благодаря TTL индексам, удаление таких документов из коллекции может происходить автоматически. TTL индекс можно создать только по полю, которое содержит дату или массив дат:
```ts
db.sessions.createIndex({ "createdAt": 1 }, { "expireAfterSeconds": DAY_IN_SECONDS });
```
Поле `createdAt` содержит дату создания сессии, а в опции `expireAfterSeconds` нужно передать количество секунд, после которого документ должен быть удалён. Таким образом, документ с сессией будет удалён через день после создания.

Если поле содержит массив дат, то для вычисления времени удаления будет использована самая ранняя